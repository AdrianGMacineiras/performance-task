spring:
  application:
    name: similar-products-service
  task:
    execution:
      pool:
        core-size: 12
        max-size: 64
        queue-capacity: 500
        keep-alive: 30s
      thread-name-prefix: async-task-
  jpa:
    open-in-view: false

server:
  port: 5000
  compression:
    enabled: true
    mime-types: application/json
    min-response-size: 1024
  tomcat:
    threads:
      max: 300
      min-spare: 50
    max-connections: 10000
    accept-count: 200

product-service:
  base-url: http://localhost:3001
  timeout: 8s
  concurrency: 1000
  service:
    similar-products-timeout: 2s
    concurrency-level: 8
  rest-template:
    connect-timeout: 2s
    read-timeout: 6s
    max-connections: 200
    max-connections-per-route: 100
  webclient:
    base-url: http://localhost:3001
    timeout: 8s
    response-timeout: 6s
    connection-timeout: 2s
    read-timeout: 6s
    write-timeout: 6s
    max-connections: 100
    max-idle-time: 20s
    max-life-time: 2m
    pending-acquire-timeout: 3s
    max-in-memory-size: 16MB
    connection-pool-name: custom-pool
  circuit-breaker:
    name: productDetailCB
    failure-rate-threshold: 40
    wait-duration-in-open-state: 6s
    sliding-window-size: 120
    minimum-number-of-calls: 20
    slow-call-rate-threshold: 35
    slow-call-duration-threshold: 1000ms
  cache:
    maximum-size: 3000
    expire-after-write: 6m
    expire-after-access: 90s
    record-stats: true
  external-api:
    url: http://simulado:80

# Resilience4j configuration for circuit breakers
resilience4j:
  circuitbreaker:
    instances:
      "${product-service.circuit-breaker.name}":
        failure-rate-threshold: ${product-service.circuit-breaker.failure-rate-threshold}
        wait-duration-in-open-state: ${product-service.circuit-breaker.wait-duration-in-open-state}
        sliding-window-size: ${product-service.circuit-breaker.sliding-window-size}
        minimum-number-of-calls: ${product-service.circuit-breaker.minimum-number-of-calls}
        slow-call-rate-threshold: ${product-service.circuit-breaker.slow-call-rate-threshold}
        slow-call-duration-threshold: ${product-service.circuit-breaker.slow-call-duration-threshold}



