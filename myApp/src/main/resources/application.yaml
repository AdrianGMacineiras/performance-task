spring:
  application:
    name: similar-products-service
  server:
    port: 5000
    compression:
      enabled: true
      mime-types: application/json
      min-response-size: 1024

product-service:
  base-url: http://localhost:3001
  timeout: 8s
  concurrency: 1000
  rest-template:
    connect-timeout: 5s
    read-timeout: 8s
    max-connections: 200
    max-connections-per-route: 200
  webclient:
    base-url: http://localhost:3001
    timeout: 8s
    response-timeout: 8s
    connection-timeout: 3s
    read-timeout: 8s
    write-timeout: 8s
    max-connections: 1000
    max-idle-time: 30s
    max-life-time: 5m
    pending-acquire-timeout: 5s
    max-in-memory-size: 16MB
  circuit-breaker:
    name: productDetailCB
    failure-rate-threshold: 50
    wait-duration-in-open-state: 10s
    sliding-window-size: 100
    minimum-number-of-calls: 20
    slow-call-rate-threshold: 50
    slow-call-duration-threshold: 5s
  cache:
    maximum-size: 1000
    expire-after-write: 30m
    expire-after-access: 10m
    record-stats: true
  external-api:
    url: http://simulado:80

# Resilience4j configuration for circuit breakers
resilience4j:
  circuitbreaker:
    instances:
      "${product-service.circuit-breaker.name}":
        failure-rate-threshold: ${product-service.circuit-breaker.failure-rate-threshold}
        wait-duration-in-open-state: ${product-service.circuit-breaker.wait-duration-in-open-state}
        sliding-window-size: ${product-service.circuit-breaker.sliding-window-size}
        minimum-number-of-calls: ${product-service.circuit-breaker.minimum-number-of-calls}
        slow-call-rate-threshold: ${product-service.circuit-breaker.slow-call-rate-threshold}
        slow-call-duration-threshold: ${product-service.circuit-breaker.slow-call-duration-threshold}


